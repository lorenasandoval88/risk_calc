<!DOCTYPE html>

    <head>
    
        <link href="https://netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">

        <script src="https://episphere.github.io/epibox/epibox.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/3.3.0/math.min.js"></script>
        <link href="style.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.6.3/css/bootstrap-select.min.css" />
    </head>


    <body>
      
      <h1>Personal Genotype Risk Calculator</h1><br>
      <p>A polygenic risk score estimates the genetic risk of an individual for some disease or trait, calculated by aggregating the effect of many common variants associated with the condition. Read more 
        <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7612115/#:~:text=In%20the%20standard%20approach%20%5B5,powerful%20GWAS%20on%20the%20phenotype">here.</a>
      </p>
      <b>The basic equation for the PRS of an individual i is:</b><br>
      <img src="prs2.png" alt="PRS equation" width="300" height="80"/><br>
      <li>beta = Weights (example is B as the per allele log odds ratio for the minor allele)</li>
      <li>k = Allele dosage for the SNP (0,1, or 2)</li>
      <li>m = number of SNPS</li><br>

      <b>Workflow for calculating risk:</b>
      <li>Retrieve scoring file from 
        <a href="https://www.pgscatalog.org/rest/">PGS catalog</a>
      </li>  
      <li>Retrieve genotype from genotype raw data file (AncestryDNA or 23AndMe) </li>
      <li>Match scoring file variants and calculate scores</li>
      <br>
      
      <!-- PGS scores------->
      <h2>PGS Risk Scores</h2>
      <select class="selectpicker" id="traitName" data-live-search="true" > </select>
      
      <input id="pgsInput" type="text" value="PGS000001" >
      <p id = "pgsFileInfo"></p>
      <button id="pgsButton" onclick=" prscore.loadPGSfromEFO() "> Load PGS </button>
      <textarea id="pgsArea" ></textarea>
      <br><br>
      
      <!-- Genomic data----->
      <h2>Genomic Data</h2>
      <input type="file" id="input-file" onchange="prscore.processUserFile(event, 'genomArea')">
      <textarea id="genomArea" class="content-target" ></textarea>
      <br><br>

      <!-- Risk result------>
      <h2>Risk results</h2>
      <p id = "variantMatches"></p>
      <div id = resDiv class="result-empty" >Please load genomic file...</div>
      <br>
      
      <button onclick=" prscore.showScoreResult() "> Calculate Risk Score </button>
      <br>
      
    <div id = endDiv>
      <p class="info" style="font-size:10px;"> All computation takes place in this browser session. No data is transmited to a server, because there is no server supporting this application. The main purpose of this tool is indeed to illustrate how serverless statistical proceedures, particulalry data wrangling, 
        can migrate to where the data is without exposing the source data. </p>
    </div>
    
      <script src="https://episphere.github.io/pgs/pgs.js"></script>
      
      <script src="helper.js"></script>
      <script src="prscore.js"></script>
        
      <script>
        prscore.processPGSEntry();
        prscore.loadTraits();
      </script>
      
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.6.3/js/bootstrap-select.min.js"></script>
      
    </body>


</html>
